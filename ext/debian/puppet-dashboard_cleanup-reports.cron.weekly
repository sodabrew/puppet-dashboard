#!/bin/bash

set -u

PUPPET_DB_PATH=/usr/share/puppet-dashboard

# Prune records up to one month old:
UPTO=10
# Valid units of time are: hr,day,wk,min,yr,mon
UNIT=mon

output=`rake -s -f ${PUPPET_DB_PATH}/Rakefile RAILS_ENV=production reports:prune upto=${UPTO} unit=${UNIT} 2>&1 1> /dev/null`
if [ $? -ne 0 ]; then
  logger -i "${output}"
fi
